<!doctype html>
<html lang="en">
   <head>
      <!-- Required meta tags -->
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
      <!-- Bootstrap CSS -->
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
      
      <link href="https://fonts.googleapis.com/css?family=Droid+Serif" rel="stylesheet" type="text/css">
      
      <title>Bấm để xem Mẫu đùi</title>
   </head>
   <body>
    <h1 id="countdown" class="d-flex justify-content-center" style="font-size:30vw;padding: 30px;"></h1>
	  <div id="idtt" class="d-flex justify-content-center" style="font-size:30px"></div>

      <!-- Optional JavaScript -->
      <!-- jQuery first, then Popper.js, then Bootstrap JS -->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

      <script type="text/javascript">
		// Lấy chuỗi tham số từ URL
		const queryString = window.location.search; // Output: "?name=John&age=30"
		
		// Cắt bỏ dấu "?" ban đầu
		const cleanString = queryString.substring(1); // Output: "name=John&age=30"
		
		// Tách chuỗi thành mảng các cặp key-value
		const paramPairs = cleanString.split('&'); // Output: ["name=John", "age=30"]
		
		const params = {};
		paramPairs.forEach(pair => {
		  const [key, value] = pair.split('=');
		  // decodeURIComponent để xử lý các ký tự đặc biệt
		  params[key] = decodeURIComponent(value);
		});
		
		//console.log(params.name); // Output: "John"
		//console.log(params.age);  // Output: "30"
		// Thời gian mục tiêu để đếm ngược đến (định dạng HH:MM:SS)
        const targetTime = params.timeend; 
        
        // Lấy thẻ h1 để hiển thị thời gian
        const h1Element = document.getElementById('countdown');
		const dividtt = document.getElementById('idtt');
		dividtt.textContent=params.ttid;
		let countdownInterval;
        function updateCountdown() {
            // Lấy thời gian hiện tại
            const now = new Date();
            
            // Tạo đối tượng Date cho thời gian mục tiêu của ngày hôm nay
            const [targetHour, targetMinute, targetSecond] = targetTime.split(':').map(Number);
            const targetDate = new Date();
            targetDate.setHours(targetHour, targetMinute, targetSecond, 0); // Đặt mili giây về 0 để tính toán chính xác

            // Nếu thời gian mục tiêu đã qua, đặt mục tiêu là ngày hôm sau
            if (now > targetDate) {
                targetDate.setDate(targetDate.getDate() + 1);
            }

            // Tính khoảng thời gian còn lại (tính bằng mili giây)
            const timeLeft = targetDate.getTime() - now.getTime();
			if (timeLeft > 300000) {
                clearInterval(countdownInterval);
				h1Element.style.backgroundColor = 'transparent';
				return;
            }
			// Kiểm tra nếu còn dưới 1 giây để chuyển màu
            if (timeLeft < 1000) {
                h1Element.style.backgroundColor = 'aqua'; // Chuyển màu nền sang xanh
                h1Element.style.color = '#fff'; // Đặt màu chữ là trắng để dễ nhìn
            } else {
                h1Element.style.backgroundColor = 'transparent'; // Trả lại màu nền trong suốt
                h1Element.style.color = '#e53e3e'; // Trả lại màu chữ ban đầu
            }
			
            // Chuyển đổi mili giây sang hh:mm:ss.sss
            const hours = Math.floor(timeLeft / (1000 * 60 * 60));
            const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
            const milliseconds = Math.floor((timeLeft % 1000) / 100);

            // Định dạng chuỗi để luôn có 2 chữ số (giờ, phút, giây) và 3 chữ số (mili giây)
            const formattedHours = String(hours).padStart(2, '0');
            const formattedMinutes = String(minutes).padStart(2, '0');
            const formattedSeconds = String(seconds).padStart(2, '0');

            // Hiển thị thời gian còn lại lên thẻ h1
            h1Element.textContent = `${formattedMinutes}:${formattedSeconds}.${milliseconds}`;
        }

        // Cập nhật đồng hồ lần đầu tiên khi tải trang
        updateCountdown();

        // Cập nhật đồng hồ mỗi 10 mili giây để có hiệu ứng mượt mà
        countdownInterval = setInterval(updateCountdown, 10);
      </script>
      
   </body>
</html>



























