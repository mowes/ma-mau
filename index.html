<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thanh Tiến Trình Mili Giây</title>
    <!-- Tải Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Cấu hình Font Inter và màu sắc -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Nền xám nhạt */
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <!-- Thẻ bao ngoài chính -->
    <div class="w-full max-w-2xl bg-white shadow-xl rounded-xl p-6 md:p-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-6 text-center">Tiến Trình Mili Giây Hiện Tại</h1>
        
        <!-- Khu vực hiển thị thời gian và tiến trình -->
        <div class="space-y-6">
            
            <!-- Hiển thị Thời gian số (Giây và Mili giây) -->
            <div class="flex flex-col items-center justify-center bg-indigo-50 p-4 rounded-lg">
                <p class="text-sm font-medium text-gray-600 uppercase tracking-wider">Thời Gian Hiện Tại (HH:MM:SS.ms)</p>
                <div id="time-display" class="text-5xl md:text-6xl font-extrabold text-indigo-700 mt-1">
                    00:00:00.000
                </div>
            </div>

            <!-- Thanh tiến trình -->
            <div>
                <p class="text-lg font-semibold text-gray-700 mb-2">Mili Giây Trong Giây Hiện Tại (0-999):</p>
                <div class="w-full bg-gray-200 rounded-full h-8 overflow-hidden shadow-inner">
                    <div id="progress-bar" 
                         class="h-8 bg-gradient-to-r from-indigo-500 to-purple-600 transition-all duration-100 ease-linear rounded-full" 
                         style="width: 0%;">
                    </div>
                </div>
                <div id="ms-text" class="text-right text-sm font-mono mt-1 text-gray-600">0 ms</div>
            </div>
            
        </div>
    </div>

    <script>
        // Lấy các phần tử DOM cần thiết
        const progressBar = document.getElementById('progress-bar');
        const msText = document.getElementById('ms-text');
        const timeDisplay = document.getElementById('time-display');

        /**
         * Hàm padding: Thêm số 0 vào đầu nếu cần
         * @param {number} num - Số cần thêm padding
         * @param {number} size - Kích thước chuỗi mong muốn
         * @returns {string} Chuỗi đã thêm padding
         */
        function pad(num, size) {
            let s = "000" + num;
            return s.substring(s.length - size);
        }

        /**
         * Cập nhật hiển thị thời gian và thanh tiến trình
         */
        function updateProgress() {
            const now = new Date();
            
            // 1. Tính toán Mili giây
            const milliseconds = now.getMilliseconds();
            
            // 2. Tính toán Phần trăm
            // Mili giây chạy từ 0 đến 999.
            const percentage = (milliseconds / 1000) * 100;

            // 3. Cập nhật Thanh Tiến trình Width
            progressBar.style.width = percentage.toFixed(2) + '%';
            
            // --- LOGIC MÀU: Chuyển sang ĐỎ khi 500ms <= ms < 600ms ---
            const isRedTime = milliseconds >= 500 && milliseconds < 600;

            // Định nghĩa các lớp màu
            const gradientClasses = ['bg-gradient-to-r', 'from-indigo-500', 'to-purple-600'];
            const redClass = 'bg-red-600';
            const pulseClass = 'animate-pulse';

            if (isRedTime) {
                // CHUYỂN SANG ĐỎ (50% đến 60%)
                
                // 1. Loại bỏ Gradient
                gradientClasses.forEach(c => progressBar.classList.remove(c));
                
                // 2. Thêm màu Đỏ và hiệu ứng rung nhẹ
                progressBar.classList.add(redClass, pulseClass);
            } else {
                // TRẢ VỀ MÀU CŨ (Gradient)
                
                // 1. Loại bỏ màu Đỏ và hiệu ứng rung
                progressBar.classList.remove(redClass, pulseClass);
                
                // 2. Thêm lại Gradient
                gradientClasses.forEach(c => progressBar.classList.add(c));
            }
            // -------------------------------------------------------------

            // 4. Cập nhật Mili giây bằng số
            msText.textContent = `${pad(milliseconds, 3)} ms`;

            // 5. Cập nhật hiển thị thời gian đầy đủ
            const hours = pad(now.getHours(), 2);
            const minutes = pad(now.getMinutes(), 2);
            const seconds = pad(now.getSeconds(), 2);
            const msPadded = pad(milliseconds, 3);
            
            timeDisplay.textContent = `${hours}:${minutes}:${seconds}.${msPadded}`;

            // Yêu cầu trình duyệt cập nhật lại càng nhanh càng tốt (thường là 60 lần/giây)
            requestAnimationFrame(updateProgress);
        }

        // Bắt đầu vòng lặp cập nhật
        updateProgress();
        
        // Ghi chú: Sử dụng requestAnimationFrame thay vì setInterval để đảm bảo
        // hiệu suất mượt mà nhất và đồng bộ với tốc độ khung hình của trình duyệt.
    </script>
</body>
</html>
